<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flying With Joel - Flight Sim Setup</title>
    <meta name="description" content="Join Flying With Joel for epic flight simulation streams! Explore Microsoft Flight Simulator 2024 and X-Plane 12 with professional setups and scenic flights.">
    
    <!-- Open Graph Meta Tags (for embeds on Discord, Twitter, Facebook, etc) -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://flyingwithjoel.co.uk/">
    <meta property="og:title" content="Flying With Joel - Flight Simulation Streams">
    <meta property="og:description" content="Join me for epic flight simulation streams! Explore Microsoft Flight Simulator 2024 and X-Plane 12 with professional setups and scenic flights.">
    <meta property="og:image" content="https://flyingwithjoel.co.uk/assets/hero-plane.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Flying With Joel - Flight Simulation Streams">
    <meta name="twitter:description" content="Join me for epic flight simulation streams! Explore MSFS 2024 and X-Plane 12 with professional setups and scenic flights.">
    <meta name="twitter:image" content="https://flyingwithjoel.co.uk/assets/hero-plane.jpg">
    
    <!-- Google Fonts is loaded only after consent (see assets/js/main.js) -->
    <link rel="stylesheet" href="assets/css/styles.css">
    <!-- Twitch Embed SDK - Loaded after consent check -->

    <script src="assets/js/site-mode.js"></script>

</head>
<body>
    <!-- Cookie Consent Banner -->
    <div id="cookie-consent-banner" style="position: fixed; bottom: 0; left: 0; right: 0; background: rgba(26, 26, 26, 0.98); border-top: 2px solid #0066ff; padding: 1.5rem; z-index: 10000; box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.5); font-family: 'Poppins', sans-serif; display: none;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <div style="display: flex; align-items: flex-start; gap: 2rem; flex-wrap: wrap; justify-content: space-between;">
                <div style="flex: 1; min-width: 250px;">
                    <p style="margin: 0 0 0.5rem 0; color: #e0e0e0; font-size: 0.95rem;">
                        <strong>Your Privacy Matters</strong> - We use localStorage to remember your choices (for example, whether you've opted in to optional third-party embeds/resources). Optional third-party services (Google Fonts, Twitch, YouTube) may set cookies or use similar technologies after you opt in.
                    </p>
                    <p style="margin: 0; color: #a0a0a0; font-size: 0.85rem;">
                        Learn more: <a href="pages/privacy.html" style="color: #0066ff; text-decoration: none; font-weight: 500;">Privacy Policy</a> | <a href="pages/cookies.html" style="color: #0066ff; text-decoration: none; font-weight: 500;">Cookie Policy</a> | <a href="pages/terms.html" style="color: #0066ff; text-decoration: none; font-weight: 500;">Terms of Service</a>
                    </p>
                </div>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button id="cookie-accept-btn" style="background: #0066ff; color: white; border: none; padding: 0.7rem 1.5rem; border-radius: 0.4rem; cursor: pointer; font-weight: 600; font-size: 0.9rem; transition: background 0.2s; white-space: nowrap;">Accept All</button>
                    <button id="cookie-reject-btn" style="background: transparent; color: #a0a0a0; border: 1px solid #404040; padding: 0.7rem 1.5rem; border-radius: 0.4rem; cursor: pointer; font-weight: 600; font-size: 0.9rem; transition: all 0.2s; white-space: nowrap;">Reject Non-Essential</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Header -->
    <nav class="navbar navbar--v2">
        <div class="nav-container">
            <div class="logo">flywithjoel</div>
            <button class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links" id="nav-links">
                <li><a href="pages/schedule.html"><span class="nav-icon" aria-hidden="true">üìÖ</span>Schedule</a></li>
                <li><a href="#highlights"><span class="nav-icon" aria-hidden="true">‚ú®</span>Highlights</a></li>
                <li><a href="pages/achievements.html"><span class="nav-icon" aria-hidden="true">üèÜ</span>Achievements</a></li>
                <li><a href="#faq"><span class="nav-icon" aria-hidden="true">‚ùì</span>FAQ</a></li>
                <li><a href="#affiliates"><span class="nav-icon" aria-hidden="true">ü§ù</span>Affiliates</a></li>
                <li><a href="pages/suggestions.html"><span class="nav-icon" aria-hidden="true">üí°</span>Suggestions</a></li>
                <li><a href="https://www.twitch.tv/Flyingwithjoel" target="_blank" class="follow-btn"><span class="nav-icon" aria-hidden="true">‚ñ∂Ô∏è</span>Follow Me</a></li>
            </ul>
        </div>
    </nav>

    <!-- Next Stream Banner (Hidden - no longer needed) -->
    <div id="next-stream-banner" style="display: none;"></div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>Flying With Joel</h1>
            <p>Welcome to my flight simulation channel! Join me as I explore the skies in Microsoft Flight Simulator 2024 and X-Plane 12. From scenic flights to challenging approaches, we'll experience aviation together.</p>
            <a href="https://linktr.ee/AviationJoel" target="_blank" class="cta-btn">
            <!-- Removed duplicate .cta-btn, only .contact-link remains -->
            <a href="https://linktr.ee/AviationJoel" target="_blank" class="contact-link" style="margin-top: 1.2rem;">
                <span class="icon">‚Üó</span> Connect With Me
            </a>
            <div class="stats">
                <div class="stat-box">
                    <span class="stat-icon">üë•</span>
                    <div>
                        <span class="stat-number" id="twitch-follower-count">478</span>
                        <span class="stat-label">Twitch Followers</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero-image">
            <img src="assets/hero-plane.jpg" alt="Flight Simulator">
        </div>
    </section>

    <!-- Upcoming Streams Section -->
    <section id="schedule" class="upcoming-section">
        <div class="schedule-header">
            <div class="schedule-icon">üìÖ</div>
            <div>
                <h2>7 Day Schedule</h2>
                <p class="schedule-subtitle">Check out when I'm taking off next. VOD availability varies by stream.</p>
            </div>
        </div>
        <div class="card" style="max-width: 900px; margin: 1.5rem auto 0; text-align: center;">
            <p class="section-subtitle" style="margin-bottom: 1rem;">The full 7 day schedule now lives on its own page.</p>
            <a href="pages/schedule.html" class="cta-btn" style="display: inline-flex; align-items: center; gap: 0.5rem;">
            <!-- Removed duplicate .cta-btn, only .contact-link remains -->
            <a href="pages/schedule.html" class="contact-link" style="margin-top: 1.2rem;">
                <span class="icon">‚Üó</span> View Schedule
            </a>
        </div>
    </section>

    <!-- Highlights Section -->
    <section id="highlights" class="highlights-section">
        <h2>Recent Highlights</h2>
        <p class="section-subtitle">Check out the best moments from recent streams</p>
        <div class="highlights-grid" id="highlights-grid">
            <!-- Highlights will be loaded here by JavaScript -->
            <p style="grid-column: 1 / -1; text-align: center; color: var(--text-muted);">Loading highlights...</p>
        </div>
    </section>


    <!-- My Setup Section -->
    <section id="setup" class="setup-section">
        <h2>My Setup</h2>
        <p class="section-subtitle">
            Explore my sim configuration and hardware
            <span style="display: block; margin-top: 0.35rem;">
                <a href="pages/setup.html" style="color: var(--primary); text-decoration: none; font-weight: 600;">Open this section on its own page ‚Üó</a>
            </span>
        </p>

        <!-- Tab Navigation -->
        <div class="tabs-container">
            <button class="tab-btn active" data-tab="sim-settings">
                <span class="icon">‚öôÔ∏è</span> Sim Settings
            </button>
            <button class="tab-btn" data-tab="addons">
                <span class="icon">üéÅ</span> MSFS Addons
            </button>
            <button class="tab-btn" data-tab="addons2">
                <span class="icon">üéÅ</span> X-Plane Addons
            </button>
            <button class="tab-btn" data-tab="graphics">
                <span class="icon">üì∫</span> Graphics
            </button>
        </div>

        <!-- Tab Content -->
        <div class="tabs-content">
            <!-- Sim Settings Tab -->
            <div id="sim-settings" class="tab-content active">
                <div class="content-grid">
                    <div class="card">
                        <h3>üíª PC Specifications</h3>
                        <div class="specs-list">
                            <div class="spec-row">
                                <span class="spec-label">Cpu:</span>
                                <span class="spec-value">Intel Core i7 14700KF</span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Gpu:</span>
                                <span class="spec-value">NVIDIA RTX 4080 Super 16GB</span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Ram:</span>
                                <span class="spec-value">64GB DDR5-6000</span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Storage:</span>
                                <span class="spec-value">3TB NVMe SSD</span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Monitor:</span>
                                <span class="spec-value">MSI 27" inch 4K Monitor</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>üéôÔ∏è Peripherals</h3>
                        <div class="specs-list">
                            <div class="spec-row">
                                <span class="spec-label">Microphone:</span>
                                <span class="spec-value"><a href="https://www.shure.com/en-US/products/microphones/sm7b" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">Shure SM7B</a></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Headset:</span>
                                <span class="spec-value"><a href="https://steelseries.com/en-gb/gaming-headsets/arctis-nova-3?connectivityType=wired&color=black&primaryPlatform=pc" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">SteelSeries Arctis Nova 3</a></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Keyboard:</span>
                                <span class="spec-value"><a href="https://steelseries.com/en-gb/gaming-keyboards/apex-3" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">SteelSeries Apex 3 Gaming Keyboard</a></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Mouse:</span>
                                <span class="spec-value"><a href="https://www.logitechg.com/en-us/products/gaming-mice/pro-wireless-mouse.html" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">Logitech G Pro Wireless</a></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Audio Interface Hub:</span>
                                <span class="spec-value"><a href="https://www.tc-helicon.com/product.html?modelCode=0803-AAA" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">GoXLR</a></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Streamdeck (32 Keys):</span>
                                <span class="spec-value"><a href="https://www.elgato.com/en/gaming/stream-deck" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">Elgato Stream Deck</a></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">MCDU:</span>
                                <span class="spec-value"><a href="https://uk.winctrl.com/view/goods-details.html?id=945" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">WinWing Airbus MCDU</a></span>
                            </div>
                                <div class="spec-row">
                                <span class="spec-label">Elgato Key Light:</span>
                                <span class="spec-value"><a href="https://www.elgato.com/en/gaming/key-light" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">Elgato Key Light</a></span>
                            </div>
                            <div class="spec-row">
                                <span class="spec-label">Yoke/Sidestick:</span>
                                <span class="spec-value"><a href="https://www.thrustmaster.com/products/tca-captain-pack-x-airbus-edition/" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">Thrustmaster TCA Airbus Edition</a></span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>üõ©Ô∏è Microsoft Flight Simulator 2024</h3>
                        <div class="sim-settings">
                            <div class="setting-group">
                                <span class="setting-label">Flight Model</span>
                                <span class="setting-value">Modern</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Assistance Preset</span>
                                <span class="setting-value">Hard</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Control Settings</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Joystick: Thrustmaster T.16000M</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Rudder: Thrustmaster TFRP</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Throttle: Thrustmaster TWCS</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Sensitivity: Medium</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Realism Settings</span>
                                <div class="tag-group">
                                    <span class="tag">turbulence</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3>‚úàÔ∏è X-Plane 12</h3>
                        <div class="sim-settings">
                            <div class="setting-group">
                                <span class="setting-label">Flight Model</span>
                                <span class="setting-value">High Fidelity</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Weather Engine</span>
                                <span class="setting-value">Real Weather Connector</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Control Settings</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Joystick: Thrustmaster T.16000M</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Rudder: Thrustmaster TFRP</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Throttle: Thrustmaster TWCS</span>
                            </div>
                            <div class="setting-group control-setting-detail">
                                <span class="setting-label"></span>
                                <span class="setting-value">Response: 80%</span>
                            </div>
                            <div class="setting-group">
                                <div class="physics-row">
                                    <span class="setting-label">Physics Settings</span>
                                    <div class="tag-group">
                                        <span class="tag">true</span>
                                        <span class="tag">Realistic</span>
                                        <span class="tag">High Detail</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="performance-tips-card">
                    <h3>üí° Performance Tips</h3>
                    <ul class="tips-list">
                        <li>Use NVIDIA DLSS if available for better performance</li>
                        <li>Limit terrain detail pre-caching to 100 miles for smooth FPS</li>
                        <li>Disable rolling cache if experiencing stutters</li>
                        <li>Use High instead of Ultra for clouds if FPS drops below 40</li>
                        <li>Keep GPU drivers updated for optimal performance</li>
                    </ul>
                </div>
            </div>

            <!-- Addons Tab -->
            <div id="addons" class="tab-content">
                <div class="content-grid">
                    <!-- ...existing Addons content... (see above) ... -->
                    <div class="card">
                        <h3>‚úàÔ∏è Aircraft</h3>
                        <div class="addon-list">
                            <a href="https://www.pmdg.com/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">PMDG 737-800</span>
                                <span class="addon-info">MSFS 2024 ‚Ä¢ Study-level Airliner</span>
                            </a>
                            <a href="https://www.fenixsim.com/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">Fenix A320</span>
                                <span class="addon-info">MSFS 2024 ‚Ä¢ Study-level Airliner</span>
                            </a>
                            <a href="https://inibuilds.com/products/inibuilds-a350-airliner-msfs-2024" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">Inibuilds A350</span>
                                <span class="addon-info">MSFS 2024 ‚Ä¢ High Fidelity Airliner</span>
                            </a>
                            <a href="https://inibuilds.com/products/inibuilds-a340-airliner-msfs-2024" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">inibuilds A340 Airliner</span>
                                <span class="addon-info">MSFS 2024 ‚Ä¢ High Fidelity Airliner</span>
                            </a>
                            <a href="https://inibuilds.com/products/tfdi-design-md-11-msfs" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">TFDI Design MD-11</span>
                                <span class="addon-info">MSFS 2024 ‚Ä¢ High Fidelity Airliner</span>
                            </a>
                            <!-- Add new aircraft addons below this line -->
                        </div>
                    </div>
                    <div class="card">
                        <h3>üåç Scenery</h3>
                        <div class="addon-list">
                            <div class="addon-item addon-link" style="cursor: default; opacity: 0.92;" role="note" aria-label="Scenery list coming soon">
                                <span class="addon-name">Soon to be updated</span>
                                <span class="addon-info">Scenery list is being refreshed</span>
                            </div>
                            <!-- Add new scenery addons below this line -->
                        </div>
                    </div>
                    <div class="card">
                        <h3>üõ†Ô∏è Utilities</h3>
                        <div class="addon-list">
                            <a href="https://www.littlenavmap.org/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">Little Navmap</span>
                                <span class="addon-info">Flight Planning & Navigation</span>
                            </a>
                            <a href="https://www.vatsim.net/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">VATSIM vPilot</span>
                                <span class="addon-info">Online Flying Network</span>
                            </a>
                            <a href="https://www.simbrief.com/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">SimBrief</span>
                                <span class="addon-info">Flight Plan Generator</span>
                            </a>
                            <a href="https://skyvector.com/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">SkyVector</span>
                                <span class="addon-info">Aviation Charts</span>
                            </a>
                            <a href="https://rkapps.shop/products/fsrealistic-plus" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">FS Realistic+</span>
                                <span class="addon-info">Realistic Flight Simulator Effects</span>
                            </a>
                            <!-- Add new utility addons below this line -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Addons X-Plane 12 Tab (Duplicate) -->
            <div id="addons2" class="tab-content">
                <div class="content-grid">
                    <!-- Duplicated Addons content -->
                    <div class="card">
                        <h3>‚úàÔ∏è Aircraft</h3>
                        <div class="addon-list">
                            <a href="https://toliss.com/pages/a330-900" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">Toliss A330-900</span>
                                <span class="addon-info">X Plane 12 ‚Ä¢ Study-level Airliner</span>
                            </a>
                            <a href="https://toliss.com/pages/a321-neo" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">Toliss A321</span>
                                <span class="addon-info">X Plane 12 ‚Ä¢ Study-level Airliner</span>
                            </a>
                            <a href="https://flightfactor.aero/where_to_buy/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">Flight Factor 777v2</span>
                                <span class="addon-info">X Plane 12 ‚Ä¢ High Fidelity Airliner</span>
                            </a>
                            <!-- Add new aircraft addons below this line -->
                        </div>
                    </div>
                    <div class="card">
                        <h3>üåç Scenery</h3>
                        <div class="addon-list">
                            <div class="addon-item addon-link" style="cursor: default; opacity: 0.92;" role="note" aria-label="Scenery list coming soon">
                                <span class="addon-name">Soon to be updated</span>
                                <span class="addon-info">Scenery list is being refreshed</span>
                            </div>
                            <!-- Add new scenery addons below this line -->
                        </div>
                    </div>
                    <div class="card">
                        <h3>üõ†Ô∏è Utilities</h3>
                        <div class="addon-list">
                            <a href="https://www.littlenavmap.org/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">Little Navmap</span>
                                <span class="addon-info">Flight Planning & Navigation</span>
                            </a>
                            <a href="https://www.vatsim.net/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">VATSIM vPilot</span>
                                <span class="addon-info">Online Flying Network</span>
                            </a>
                            <a href="https://www.simbrief.com/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">SimBrief</span>
                                <span class="addon-info">Flight Plan Generator</span>
                            </a>
                            <a href="https://skyvector.com/" target="_blank" class="addon-item addon-link">
                                <span class="addon-name">SkyVector</span>
                                <span class="addon-info">Aviation Charts</span>
                            </a>
                            <!-- Add new utility addons below this line -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Graphics Tab -->
            <div id="graphics" class="tab-content">
                <div class="content-grid">
                    <div class="card">
                        <h3>üéÆ MSFS 2024 Graphics</h3>
                        <div class="graphics-settings">
                            <div class="setting-group">
                                <span class="setting-label">Preset</span>
                                <span class="setting-value">Custom</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Resolution</span>
                                <span class="setting-value">2560x1440</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Anti Aliasing</span>
                                <span class="setting-value">TAA</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Terrain Level of Detail</span>
                                <span class="setting-value">150%</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Quality Settings</span>
                                <div class="tag-group">
                                    <span class="tag">Clouds: Ultra</span>
                                    <span class="tag">Terrain: Ultra</span>
                                    <span class="tag">Water: Ultra</span>
                                    <span class="tag">Reflections: Ultra</span>
                                    <span class="tag">Shadows: Ultra</span>
                                    <span class="tag">Volumetric Clouds: Ultra</span>
                                </div>
                            </div>
                        </div>
                        <div data-embed="youtube" data-src="https://www.youtube-nocookie.com/embed/eZS-YndjDWo" style="margin-top: 1.5rem; position: relative; width: 100%; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 0.4rem;">
                            <div class="embed-placeholder" style="position: absolute; inset: 0; display: none; align-items: center; justify-content: center; flex-direction: column; gap: 0.75rem; padding: 1rem; text-align: center; background: rgba(10, 10, 10, 0.92); border: 1px solid rgba(255, 255, 255, 0.08);">
                                <p style="margin: 0; color: var(--text-muted); font-size: 0.9rem; line-height: 1.5;">
                                    YouTube video embeds are disabled until you accept optional third-party embeds.
                                </p>
                                <div style="display: flex; gap: 0.75rem; flex-wrap: wrap; justify-content: center;">
                                    <button type="button" class="embed-consent-btn" style="background: var(--primary); color: #0a0a0a; border: none; padding: 0.6rem 1rem; border-radius: 0.4rem; font-weight: 700; cursor: pointer;">Enable embeds</button>
                                    <a href="https://www.youtube.com/watch?v=eZS-YndjDWo" target="_blank" rel="noopener" style="color: var(--primary); text-decoration: none; font-weight: 600;">Watch on YouTube</a>
                                </div>
                            </div>
                            <iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 0.4rem;" src="" title="MSFS 2024 Graphics Guide" allowfullscreen></iframe>
                        </div>
                    </div>

                    <div class="card">
                        <h3>üéÆ X-Plane 12 Graphics</h3>
                        <div class="graphics-settings">
                            <div class="setting-group">
                                <span class="setting-label">Preset</span>
                                <span class="setting-value">Custom High</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Texture Quality</span>
                                <span class="setting-value">Maximum</span>
                            </div>
                            <div class="setting-group">
                                <span class="setting-label">Key Settings</span>
                                <div class="tag-group">
                                    <span class="tag">AA: 4x SSAA</span>
                                    <span class="tag">VFX: Maximum</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Affiliates Section -->
    <section id="affiliates" class="affiliates-section">
        <h2>Affiliate Partners</h2>
        <p class="section-subtitle">Companies and products I recommend and use</p>
        <div style="background: linear-gradient(90deg, rgba(102, 187, 106, 0.12) 0%, rgba(76, 175, 80, 0.08) 100%); border: 2px solid #4CAF50; border-radius: 0.8rem; padding: 2rem; margin-bottom: 2rem;">
            <h3 style="margin: 0 0 1rem 0; color: #66BB6A; font-size: 1.1rem;">ü§ù Affiliate Disclosure & Legal Notice</h3>
            <p style="margin: 0 0 1rem 0; color: #e0e0e0; line-height: 1.6;">
                <strong>We are affiliate partners with these companies.</strong> When you purchase through affiliate links on this page, we earn a small commission at <strong>no additional cost to you.</strong>
            </p>
            <div style="background: rgba(102, 187, 106, 0.08); border-left: 4px solid #4CAF50; padding: 1rem; border-radius: 0.4rem; margin-bottom: 1rem;">
                <p style="margin: 0; color: #d0d0d0; font-size: 0.95rem;">
                    <strong>What this means:</strong> We may earn a commission if you click our links and make a purchase. This helps support our streaming, content creation, and website maintenance.
                </p>
            </div>
            <div style="background: rgba(102, 187, 106, 0.08); border-left: 4px solid #4CAF50; padding: 1rem; border-radius: 0.4rem;">
                <p style="margin: 0; color: #d0d0d0; font-size: 0.95rem;">
                    <strong>Our promise:</strong> We only recommend products and services we genuinely use and believe in. We would recommend them even without affiliate compensation. Your trust is more important than any commission.
                </p>
            </div>
            <p style="margin: 1rem 0 0 0; color: #a0a0a0; font-size: 0.85rem;">
                <em>FTC Disclosure: In compliance with FTC guidelines, all affiliate links are clearly marked as affiliate links. For more information, see our <a href="pages/privacy.html" style="color: var(--primary); text-decoration: none; font-weight: 600;">Privacy Policy</a>.</em>
            </p>
        </div>
        <div class="affiliates-grid">
            <!-- Affiliate Template - Copy this entire div to add more -->
            <div class="affiliate-card">
                <div class="affiliate-header">
                    <h3>NONE YET</h3>
                    <span class="affiliate-badge" style="background: #ff9800; color: white;">Affiliate</span>
                </div>
                <p class="affiliate-description">Coming soon with genuine recommendations!</p>
                <a href="#" class="affiliate-btn" style="background: #66BB6A;">Coming Soon</a>
            </div>

            <!-- Add more affiliate cards below this line -->
            <!-- Copy and paste the template above, then update: h3 (company name), affiliate-badge (category), affiliate-description (description), and href (link) -->

        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="faq-section" style="text-align: center;">
        <h2 style="text-align: center;">Frequently Asked Questions</h2>
        <p class="section-subtitle" style="text-align: center;">Find answers to common questions</p>
        <div class="faq-container" style="max-width: 800px; margin: 0 auto;">
            <!-- FAQ Item Template - Copy and paste this entire div to add more questions -->
            <div class="faq-item">
                <div class="faq-question">What simulators do you stream?</div>
                <div class="faq-answer">I primarily stream Microsoft Flight Simulator 2024 and X-Plane 12. Both offer incredible realism and different experiences for flight simulation enthusiasts.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">What time do you stream?</div>
                <div class="faq-answer">Check my 7 Day Schedule section for exact times. Most streams are in the afternoon/evening (Zulu time). Times vary depending on the day.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Are your streams archived?</div>
                <div class="faq-answer">Yes! Completed streams are marked on the schedule with VOD links. However, not all streams are uploaded, so availability varies.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">What hardware do you use?</div>
                <div class="faq-answer">Check the "My Setup" section for detailed information about my PC specs, aircraft addons, and control configuration.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Can I use your affiliate links?</div>
                <div class="faq-answer">Absolutely! Check the Affiliates section for products and services I recommend. Using affiliate links helps support the channel at no extra cost to you.</div>
            </div>

            <div class="faq-item">
                <div class="faq-question">Do you have a music playlist?</div>
                <div class="faq-answer"><a href="https://open.spotify.com/playlist/7KLbyutbheBIEgU5143Kik?si=4caeda9d395e457c" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500; transition: color 0.2s;">Check out my Spotify playlist</a> for the music I listen to during streams and beyond!</div>
            </div>

            <!-- Add more FAQ items below this line -->
            <!-- Copy the faq-item div above and update the question and answer -->
        </div>
    </section>

    <!-- Affiliate & Legal Disclosure Section -->
    <section class="disclosure-section" style="background: transparent; padding: 3rem 2rem; margin: 3rem 0; border-top: none; border-bottom: none;">
        <div class="container" style="max-width: 1000px; margin: 0 auto;">
            <h2 style="color: #e0e0e0; margin-bottom: 2rem; text-align: center; font-size: 1.8rem;">Important Disclosures</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem;">
                <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 0.6rem; padding: 1.5rem;">
                    <h4 style="color: #e0e0e0; margin-bottom: 1rem; font-size: 1.1rem;">ü§ù Affiliate Links</h4>
                    <p style="color: #b0b0b0; font-size: 0.95rem; line-height: 1.6;">Some links on this site are affiliate links. When you purchase through them, we earn a commission at no extra cost to you. This helps support the channel.</p>
                </div>
                <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 0.6rem; padding: 1.5rem;">
                    <h4 style="color: #e0e0e0; margin-bottom: 1rem; font-size: 1.1rem;">‚úàÔ∏è Flight Simulation Only</h4>
                    <p style="color: #b0b0b0; font-size: 0.95rem; line-height: 1.6;">All content covers flight simulation entertainment only. This is NOT aviation training. For real pilot training, consult qualified aviation instructors.</p>
                </div>
                <div style="background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 0.6rem; padding: 1.5rem;">
                    <h4 style="color: #e0e0e0; margin-bottom: 1rem; font-size: 1.1rem;">üîó Third-Party Services</h4>
                    <p style="color: #b0b0b0; font-size: 0.95rem; line-height: 1.6;">Optional third-party resources (such as Google Fonts, Twitch clips, and YouTube embeds) are disabled by default and load only after you opt in via the consent banner. See our <a href="pages/privacy.html" style="color: #0066ff; font-weight: 500; text-decoration: none;">Privacy Policy</a> for details.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Flight Simulation Disclaimer Banner -->
    <div style="background: linear-gradient(90deg, rgba(244, 67, 54, 0.12) 0%, rgba(244, 67, 54, 0.08) 100%); border: 2px solid #f44336; border-radius: 0.8rem; padding: 2rem; margin: 3rem 2rem; max-width: 1200px; margin-left: auto; margin-right: auto;">
        <div style="display: flex; align-items: flex-start; gap: 1.5rem;">
            <div style="font-size: 2rem; flex-shrink: 0; margin-top: 0.2rem;">‚ö†Ô∏è</div>
            <div>
                <h3 style="margin: 0 0 0.8rem 0; color: #f44336; font-size: 1.3rem;">Flight Simulation Disclaimer</h3>
                <p style="margin: 0 0 1rem 0; color: #e0e0e0; line-height: 1.6;">
                    <strong>Important:</strong> Flight Simulator is a video game simulation. The content on this website is for entertainment and educational purposes only.
                </p>
                <ul style="margin: 0; padding-left: 1.5rem; color: #e0e0e0; line-height: 1.8; font-size: 0.95rem;">
                    <li><strong>This is NOT real pilot training.</strong> Flight Simulator does not teach actual aviation skills required for real flying.</li>
                    <li><strong>Techniques shown may NOT apply to real aircraft.</strong> Real aviation follows strict regulations (FAA, EASA, etc.).</li>
                    <li><strong>For real flying,</strong> always consult certified flight instructors and follow all legal requirements in your jurisdiction.</li>
                    <li><strong>Viewers assume all responsibility</strong> for how they use this content.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2026 Flying With Joel. All rights reserved.</p>
            <div class="footer-links">
                <a href="pages/privacy.html">Privacy Policy</a>
                <a href="pages/terms.html">Terms of Service</a>
                <a href="pages/cookies.html">Cookie Policy</a>
                <a href="#" id="cookie-settings-link">Cookie Settings</a>
                <a href="pages/security.html">Security & Hosting</a>
                <a href="https://www.twitch.tv/Flyingwithjoel" target="_blank">Twitch</a>
            </div>
        </div>
    </footer>

    <script src="assets/js/main.js"></script>
    <script>
        // ===== GDPR Consent Helpers =====
        function hasUserConsent() {
            // Prefer the shared helper from assets/js/main.js if available.
            if (typeof hasGdprConsent === 'function') return hasGdprConsent();
            return localStorage.getItem('gdpr-consent-accepted') === 'true';
        }
        
        function loadTwitchSDK() {
            // Only load Twitch SDK if not already loaded
            if (window.Twitch) return;
            if (document.getElementById('twitch-embed-sdk')) return;
            const script = document.createElement('script');
            script.id = 'twitch-embed-sdk';
            script.src = 'https://embed.twitch.tv/embed.js';
            script.async = true;
            document.head.appendChild(script);
        }

        function initializeEmbeds() {
            // YouTube embeds
            const youtubeWrappers = document.querySelectorAll('[data-embed="youtube"]');
            youtubeWrappers.forEach(wrapper => {
                const iframe = wrapper.querySelector('iframe');
                const placeholder = wrapper.querySelector('.embed-placeholder');
                const enableBtn = wrapper.querySelector('.embed-consent-btn');
                const embedSrc = wrapper.getAttribute('data-src');

                if (enableBtn) {
                    enableBtn.addEventListener('click', () => {
                        const banner = document.getElementById('cookie-consent-banner');
                        if (banner) {
                            if (typeof showCookieBanner === 'function') showCookieBanner(banner);
                            else banner.style.display = 'flex';
                        }
                    });
                }

                if (hasUserConsent()) {
                    if (iframe && embedSrc && iframe.src !== embedSrc) {
                        iframe.src = embedSrc;
                    }
                    if (placeholder) placeholder.style.display = 'none';
                } else {
                    if (iframe) iframe.src = '';
                    if (placeholder) placeholder.style.display = 'flex';
                }
            });
        }
        
        // Initialize consent on page load
        document.addEventListener('DOMContentLoaded', function() {
            if (hasUserConsent()) {
                loadTwitchSDK();
            }

            initializeEmbeds();

            // React to consent changes (banner logic + storage is handled in assets/js/main.js)
            window.addEventListener('fwj:consent:granted', () => {
                loadTwitchSDK();
                initializeEmbeds();
                if (typeof loadHighlights === 'function') loadHighlights();
            });

            window.addEventListener('fwj:consent:rejected', () => {
                initializeEmbeds();
                // Clear any already-loaded third-party embeds (e.g., Twitch clip iframes)
                // after a user withdraws consent.
                loadHighlights();
            });
        });
        
        // ===== Original JavaScript =====
        const hamburger = document.getElementById('hamburger');
        const navLinks = document.getElementById('nav-links');

        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navLinks.classList.toggle('active');
        });

        // Close menu when a link is clicked
        const navItems = navLinks.querySelectorAll('a');
        navItems.forEach(item => {
            item.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navLinks.classList.remove('active');
            });
        });

        // Load highlights with embedded Twitch clips
        async function loadHighlights() {
            try {
                if (!hasUserConsent()) {
                    document.getElementById('highlights-grid').innerHTML = `
                        <div class="highlight-card" style="grid-column: 1 / -1; text-align: center;">
                            <div class="highlight-thumbnail" style="display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.03); position: relative;">
                                <span style="font-size: 3rem;">üîí</span>
                            </div>
                            <h4>Embeds Disabled</h4>
                            <span class="view-count" style="display: block; color: var(--text-muted);">Accept optional third-party embeds to load Twitch clips.</span>
                        </div>
                    `;
                    return;
                }

                const TWITCH_CHANNEL_NAME = 'Flyingwithjoel';
                const fallbackClips = [
                    { slug: 'MagnificentAverageLobsterOMGScoots-Ko6Vkp-DxaBMqKJO', title: 'Well that happened', views: 2 },
                    { slug: 'HotOddGalagoPJSalt-VOO8JQkss9I0bVjJ', title: 'Smooth Landing into Singapore after 18 Hours 20 Minutes From New York', views: 9 }
                ];

                let clipsFromApi = null;
                try {
                    const resp = await fetch('/api/schedule/clips?count=2', { cache: 'no-store' });
                    if (resp.ok) {
                        const json = await resp.json();
                        if (json && Array.isArray(json.clips) && json.clips.length) {
                            clipsFromApi = json.clips;
                        }
                    }
                } catch {
                    // ignore
                }
                
                let highlightsHTML = '';
                
                // Add embedded clips
                if (clipsFromApi && clipsFromApi.length) {
                    for (let clip of clipsFromApi) {
                        const title = (clip && typeof clip.title === 'string') ? clip.title : 'Twitch Clip';
                        const embedUrl = (clip && typeof clip.embedUrl === 'string') ? clip.embedUrl : null;
                        const views = (clip && typeof clip.viewCount === 'number') ? clip.viewCount : null;
                        const url = (clip && typeof clip.url === 'string') ? clip.url : null;

                        highlightsHTML += `
                            <div class="highlight-card">
                                <div class="highlight-thumbnail" style="position: relative; padding: 0; overflow: hidden;">
                                    ${embedUrl
                                        ? `<iframe src="${embedUrl}" style="width: 100%; height: 100%; border: none; display: block; position: absolute; top: 0; left: 0;" allowfullscreen></iframe>`
                                        : `<div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.03);color:var(--text-muted);">Clip unavailable</div>`
                                    }
                                </div>
                                <h4>${title}</h4>
                                <span class="view-count">üëÅÔ∏è ${(Number.isFinite(views) ? views : 0).toLocaleString()} views</span>
                                ${url ? `<a href="${url}" target="_blank" rel="noopener" style="display:inline-block;margin-top:0.35rem;color:var(--primary);text-decoration:none;font-weight:600;font-size:0.85rem;">Open on Twitch ‚Üó</a>` : ''}
                            </div>
                        `;
                    }
                } else {
                    for (let clip of fallbackClips) {
                    highlightsHTML += `
                        <div class="highlight-card">
                            <div class="highlight-thumbnail" style="position: relative; padding: 0; overflow: hidden;">
                                <iframe src="https://clips.twitch.tv/embed?clip=${clip.slug}&parent=flyingwithjoel.co.uk&parent=www.flyingwithjoel.co.uk&autoplay=false" style="width: 100%; height: 100%; border: none; display: block; position: absolute; top: 0; left: 0;" allowfullscreen></iframe>
                            </div>
                            <h4>${clip.title}</h4>
                            <span class="view-count">üëÅÔ∏è ${clip.views.toLocaleString()} views</span>
                        </div>
                    `;
                    }
                }
                
                // Add Follow on Twitch card
                highlightsHTML += `
                    <div class="highlight-card" style="cursor: pointer;" onclick="window.open('https://www.twitch.tv/${TWITCH_CHANNEL_NAME}', '_blank')">
                        <div class="highlight-thumbnail" style="display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #9147ff, #5D29FF); position: relative;">
                            <span style="font-size: 3rem;">üì∫</span>
                        </div>
                        <h4>Follow on Twitch</h4>
                        <span class="view-count">üëÅÔ∏è Join the community</span>
                    </div>
                `;
                
                document.getElementById('highlights-grid').innerHTML = highlightsHTML;
            } catch (error) {
                console.error('Could not load highlights:', error);
            }
        }

        // Load highlights on page load
        window.addEventListener('load', loadHighlights);

        // Hydrate Twitch follower count via the Cloudflare Worker (keeps credentials server-side).
        async function hydrateFollowerCount() {
            const el = document.getElementById('twitch-follower-count');
            if (!el) return;

            try {
                const resp = await fetch('/api/schedule/followers', { cache: 'no-store' });
                if (!resp.ok) return;
                const json = await resp.json();
                const n = json && typeof json.followers === 'number' ? json.followers : null;
                if (!Number.isFinite(n)) return;
                el.textContent = n.toLocaleString();
            } catch {
                // Keep the hardcoded fallback.
            }
        }

        window.addEventListener('load', hydrateFollowerCount);

        // Re-load gated embeds after consent is granted (emitted by assets/js/main.js)
        window.addEventListener('fwj:consent:granted', () => {
            initializeEmbeds();
            loadHighlights();
        });

        const SCHEDULE_API_CANDIDATES = [
            '/api/schedule',
            'https://api.flyingwithjoel.co.uk/api/schedule.php',
        ];

        const SCHEDULE_API_LOCALSTORAGE_KEY = 'fwj_schedule_api';

        const ALLOWED_API_ORIGINS = new Set([
            window.location.origin,
            'https://flyingwithjoel.co.uk',
            'https://www.flyingwithjoel.co.uk',
            'https://api.flyingwithjoel.co.uk',
        ]);

        function sanitizeApiUrl(raw) {
            const s = (raw || '').trim();
            if (!s) return null;

            if (s.startsWith('/')) {
                if (!s.startsWith('/api/')) return null;
                return s;
            }

            try {
                const u = new URL(s);
                if (u.protocol !== 'https:') return null;
                if (!ALLOWED_API_ORIGINS.has(u.origin)) return null;
                if (!u.pathname.startsWith('/api/')) return null;
                u.hash = '';
                return u.toString();
            } catch {
                return null;
            }
        }

        function getScheduleApiOverride() {
            try {
                const params = new URLSearchParams(window.location.search);
                const qp = sanitizeApiUrl(params.get('scheduleApi'));
                if (qp) {
                    localStorage.setItem(SCHEDULE_API_LOCALSTORAGE_KEY, qp);
                    return qp;
                }
            } catch {
                // ignore
            }

            try {
                const fromLs = sanitizeApiUrl(localStorage.getItem(SCHEDULE_API_LOCALSTORAGE_KEY));
                if (fromLs) return fromLs;
            } catch {
                // ignore
            }

            const meta = document.querySelector('meta[name="schedule-api"]');
            const metaVal = sanitizeApiUrl(meta ? meta.getAttribute('content') : '');
            return metaVal;
        }

        function getScheduleApiCandidates() {
            const override = getScheduleApiOverride();
            const all = [override, ...SCHEDULE_API_CANDIDATES].filter(Boolean);
            return Array.from(new Set(all));
        }

        async function fetchFirstOkJson(urls, init) {
            for (const u of urls) {
                try {
                    const resp = await fetch(u, init);
                    if (!resp.ok) continue;
                    return { url: u, data: await resp.json() };
                } catch {
                    // try next
                }
            }
            return null;
        }

        async function tryHydrateScheduleFromApi() {
            const container = document.getElementById('weekly-schedule');
            if (!container) return;

            try {
                const result = await fetchFirstOkJson(getScheduleApiCandidates(), { cache: 'no-store' });
                const items = result && result.data;
                if (!Array.isArray(items) || items.length === 0) return;

                renderWeeklySchedule(items);

                // Re-run enhancements after schedule DOM exists
                highlightToday();
                updateLiveStatus();
                addLiveCardClickHandler();
            } catch {
                // Keep the hardcoded schedule as fallback.
            } finally {
                container.classList.remove('is-hydrating');
            }
        }

        function renderWeeklySchedule(items) {
            const container = document.getElementById('weekly-schedule');
            if (!container) return;

            container.innerHTML = '';

            items.forEach((item) => {
                const card = document.createElement('div');
                card.classList.add('day-card');

                const status = (item && item.status ? String(item.status) : '').toLowerCase();
                const hasStream = status === 'scheduled' || status === 'completed' || status === 'cancelled' || status === 'delayed';
                if (hasStream) card.classList.add('has-stream');
                if (status === 'completed') card.classList.add('completed');
                if (status === 'cancelled') card.classList.add('cancelled');
                if (status === 'delayed') card.classList.add('delayed');

                const pill = document.createElement('div');
                pill.className = 'status-pill';
                if (status === 'completed') {
                    pill.textContent = 'COMPLETED';
                    pill.classList.add('completed');
                } else if (status === 'cancelled') {
                    pill.textContent = 'CANCELLED';
                    pill.classList.add('cancelled');
                } else if (status === 'delayed') {
                    pill.textContent = 'DELAYED';
                    pill.classList.add('delayed');
                } else if (status === 'scheduled') {
                    pill.textContent = 'SCHEDULED';
                    pill.classList.add('scheduled');
                } else {
                    pill.textContent = '';
                }
                if (pill.textContent) card.appendChild(pill);

                if (item && item.dateKey) {
                    card.setAttribute('data-date', String(item.dateKey));
                }

                const dayNameEl = document.createElement('div');
                dayNameEl.className = 'day-name';
                dayNameEl.textContent = item && item.dayName ? String(item.dayName) : '-';

                const dateEl = document.createElement('div');
                dateEl.className = 'day-date';
                dateEl.setAttribute('style', 'font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.5rem;');
                dateEl.textContent = item && item.dateText ? String(item.dateText) : '';

                const gameLogoEl = document.createElement('div');
                gameLogoEl.className = 'game-logo';
                gameLogoEl.textContent = item && item.gameLogo ? String(item.gameLogo) : '-';

                const streamTimeEl = document.createElement('div');
                streamTimeEl.className = 'stream-time';
                const zuluTime = item && item.zuluTime ? String(item.zuluTime) : '';
                if (zuluTime) streamTimeEl.setAttribute('data-zulu-time', zuluTime);
                streamTimeEl.textContent = item && item.timeText ? String(item.timeText) : (zuluTime || '');

                const streamTitleEl = document.createElement('div');
                streamTitleEl.className = 'stream-title';
                streamTitleEl.textContent = item && item.streamTitle ? String(item.streamTitle) : '-';

                card.appendChild(dayNameEl);
                card.appendChild(dateEl);
                card.appendChild(gameLogoEl);
                card.appendChild(streamTimeEl);
                card.appendChild(streamTitleEl);

                if (status === 'completed' && item && item.vodUrl) {
                    const vodLink = document.createElement('a');
                    vodLink.href = String(item.vodUrl);
                    vodLink.target = '_blank';
                    vodLink.rel = 'noopener noreferrer';
                    vodLink.setAttribute('style', 'font-size: 0.8rem; color: #66BB6A; margin-top: 0.5rem; font-weight: 600; text-decoration: none; display: block; cursor: pointer; transition: color 0.2s;');
                    vodLink.textContent = '‚úì Completed - Watch VOD';
                    card.appendChild(vodLink);
                }

                if (status === 'cancelled') {
                    const cancelledEl = document.createElement('div');
                    cancelledEl.setAttribute('style', 'font-size: 0.8rem; color: #ff6666; margin-top: 0.5rem; font-weight: 600;');
                    cancelledEl.textContent = '‚úñÔ∏è Cancelled';
                    card.appendChild(cancelledEl);
                }

                if (status === 'delayed') {
                    const delayedEl = document.createElement('div');
                    delayedEl.setAttribute('style', 'font-size: 0.8rem; color: #FFB74D; margin-top: 0.5rem; font-weight: 700;');
                    delayedEl.textContent = '‚è∞ Delayed';
                    card.appendChild(delayedEl);
                }

                container.appendChild(card);
            });
        }

        // Add "(Today)" to current day's schedule card
        function highlightToday() {
            const today = new Date();
            const month = today.getMonth() + 1; // getMonth() returns 0-11
            const date = today.getDate();
            const dateString = `${month}-${date}`;
            
            const dayCards = document.querySelectorAll('[data-date]');
            dayCards.forEach(card => {
                if (card.getAttribute('data-date') === dateString) {
                    const dateDiv = card.querySelector('.day-date');
                    if (dateDiv && !dateDiv.textContent.includes('(Today)')) {
                        dateDiv.textContent += ' (Today)';
                    }
                }
            });
        }

        // Run on page load
        window.addEventListener('load', highlightToday);

        // Attempt to replace the hardcoded schedule with the server-managed schedule.
        window.addEventListener('load', tryHydrateScheduleFromApi);

        // Run on page load
        window.addEventListener('load', updateLiveStatus);
        
        // Update live status and check every minute
        setInterval(updateLiveStatus, 60000);

        function ensureStatusPill(card) {
            let pill = card.querySelector('.status-pill');
            if (pill) return pill;

            pill = document.createElement('div');
            pill.className = 'status-pill';
            // Put it at the top of the card (matches the hydrated schedule layout)
            card.insertBefore(pill, card.firstChild);
            return pill;
        }

        function applyPillForCard(card, forcedText) {
            const pill = ensureStatusPill(card);

            if (forcedText === 'LIVE') {
                pill.textContent = 'LIVE';
                pill.className = 'status-pill live';
                return;
            }

            if (card.classList.contains('completed')) {
                pill.textContent = 'COMPLETED';
                pill.className = 'status-pill completed';
                return;
            }

            if (card.classList.contains('cancelled')) {
                pill.textContent = 'CANCELLED';
                pill.className = 'status-pill cancelled';
                return;
            }

            if (card.classList.contains('delayed')) {
                pill.textContent = 'DELAYED';
                pill.className = 'status-pill delayed';
                return;
            }

            if (card.classList.contains('has-stream')) {
                pill.textContent = 'SCHEDULED';
                pill.className = 'status-pill scheduled';
                return;
            }

            // No status to show
            pill.textContent = '';
            pill.className = 'status-pill';
        }

        function updateLiveStatus() {
            // Use UTC/Zulu time for accurate comparison across all timezones
            const now = new Date();
            const currentUTCHours = now.getUTCHours();
            const currentUTCMinutes = now.getUTCMinutes();
            const currentUTCTime = currentUTCHours * 60 + currentUTCMinutes; // Convert to minutes for easier comparison
            
            const dayCards = document.querySelectorAll('.day-card');
            dayCards.forEach(card => {
                const streamTimeEl = card.querySelector('.stream-time');
                if (!streamTimeEl) return;
                
                // Get the original Zulu time from data attribute
                const zuluTimeStr = streamTimeEl.getAttribute('data-zulu-time');
                if (!zuluTimeStr) {
                    card.classList.remove('live');
                    return;
                }
                
                // Parse the Zulu time (e.g., "18:00 Zulu", "15:30 Zulu", "11:00 AM Zulu")
                const timeMatch = zuluTimeStr.match(/(\d{1,2}):(\d{2})(?:\s(AM|PM))?\s+Zulu/i);
                if (!timeMatch) {
                    card.classList.remove('live');
                    return;
                }
                
                let streamHours = parseInt(timeMatch[1]);
                const streamMinutes = parseInt(timeMatch[2]);
                const period = timeMatch[3];
                
                // Handle 12-hour format with AM/PM
                if (period) {
                    if (period.toUpperCase() === 'PM' && streamHours !== 12) {
                        streamHours += 12;
                    } else if (period.toUpperCase() === 'AM' && streamHours === 12) {
                        streamHours = 0;
                    }
                }
                
                const streamUTCTime = streamHours * 60 + streamMinutes;
                
                // Check if current UTC time is within 3 hours after stream start
                const streamDuration = 600; // 3 hours in minutes
                const timeUntilStream = streamUTCTime - currentUTCTime;
                const isLive = timeUntilStream >= -streamDuration && timeUntilStream < 0;
                
                // Also check if it's the right day
                const cardDate = card.getAttribute('data-date');
                const today = new Date();
                const month = today.getMonth() + 1;
                const date = today.getDate();
                const dateString = `${month}-${date}`;
                const isToday = cardDate === dateString;
                
                const isBlockedByStatus = card.classList.contains('cancelled') || card.classList.contains('completed');
                if (isLive && isToday && !isBlockedByStatus) {
                    card.classList.add('live');
                    card.style.cursor = 'pointer';

                    applyPillForCard(card, 'LIVE');
                } else {
                    card.classList.remove('live');
                    card.style.cursor = 'default';

                    // Ensure pill is restored for non-live state too
                    applyPillForCard(card);
                }
            });
        }

        // Make live cards clickable - direct to Twitch
        function addLiveCardClickHandler() {
            const dayCards = document.querySelectorAll('.day-card');
            dayCards.forEach(card => {
                if (card.dataset.liveClickBound === '1') return;
                card.dataset.liveClickBound = '1';
                card.addEventListener('click', function() {
                    if (this.classList.contains('live')) {
                        window.open('https://www.twitch.tv/Flyingwithjoel', '_blank');
                    }
                });
            });
        }

        window.addEventListener('load', function() {
            addLiveCardClickHandler();
            // Also update click handlers every minute when live status updates
            setInterval(addLiveCardClickHandler, 60000);
        });
    </script>
</body>
</html>

