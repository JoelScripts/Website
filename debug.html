<!DOCTYPE html>
<html>
<head>
    <title>Timezone Debug</title>
</head>
<body>
    <h1>Timezone Conversion Debug</h1>
    <p>Check console for debug output</p>
    
    <script>
        function convertTimeToTimezone(zuluTimeStr, timezone) {
            console.log("Converting:", zuluTimeStr, "to", timezone);
            
            // Parse time like "18:00 Zulu", "15:30 Zulu", "11:00 AM Zulu"
            const timeMatch = zuluTimeStr.match(/(\d{1,2}):(\d{2})(?:\s(AM|PM))?\s+Zulu/i);
            
            if (!timeMatch) {
                console.log("No match found");
                return zuluTimeStr;
            }
            
            console.log("Match found:", timeMatch);
            
            let hours = parseInt(timeMatch[1]);
            const minutes = timeMatch[2];
            const period = timeMatch[3];
            
            console.log("Hours:", hours, "Minutes:", minutes, "Period:", period);
            
            // Handle 12-hour format with AM/PM
            if (period) {
                if (period.toUpperCase() === 'PM' && hours !== 12) {
                    hours += 12;
                } else if (period.toUpperCase() === 'AM' && hours === 12) {
                    hours = 0;
                }
            }
            
            console.log("Final UTC hours:", hours);
            
            // Create a UTC date with the given time
            const utcDate = new Date();
            utcDate.setUTCHours(hours, parseInt(minutes), 0);
            
            console.log("UTC Date:", utcDate);
            
            // Format to the selected timezone
            try {
                const formatter = new Intl.DateTimeFormat('en-US', {
                    timeZone: timezone,
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: false
                });
                
                const timeParts = formatter.format(utcDate);
                console.log("Formatted time parts:", timeParts);
                
                const [tzHours, tzMinutes] = timeParts.split(':');
                
                // Get timezone abbreviation
                const tzFormatter = new Intl.DateTimeFormat('en-US', {
                    timeZone: timezone,
                    timeZoneName: 'short'
                });
                const tzParts = tzFormatter.formatToParts(utcDate);
                const tzPart = tzParts.find(p => p.type === 'timeZoneName');
                const tz = tzPart ? tzPart.value : '';
                
                const result = `${tzHours}:${tzMinutes} ${tz}`;
                console.log("Result:", result);
                return result;
            } catch (e) {
                console.error("Error:", e);
                return zuluTimeStr;
            }
        }
        
        // Test
        console.log("=== Testing Timezone Conversion ===");
        console.log("Test 1:", convertTimeToTimezone("18:00 Zulu", "America/Chicago"));
        console.log("Test 2:", convertTimeToTimezone("11:00 AM Zulu", "Australia/Sydney"));
    </script>
</body>
</html>
